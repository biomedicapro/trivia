<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Estudio Interactivo - Preguntas y Flashcards</title>
  <style>
    /* Estilos generales */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
    body { background-color: #f5f5f5; color: #333; line-height: 1.6; }
    header { background-color: #fff; padding: 10px 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
    header nav { display: flex; justify-content: space-around; }
    header nav a { text-decoration: none; color: #333; padding: 8px 12px; border-radius: 4px; transition: background-color 0.3s; }
    header nav a:hover, header nav a.active { background-color: #ddd; }
    .section { display: none; padding: 20px; }
    .section.active { display: block; }
    form { max-width: 800px; margin: 0 auto; }
    form select, form input, form textarea { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }
    form button { padding: 10px 20px; border: none; background-color: #333; color: #fff; font-size: 16px; border-radius: 4px; cursor: pointer; transition: background-color 0.3s; }
    form button:hover { background-color: #555; }
    #loadingMessage, #notificacion { text-align: center; margin-top: 10px; font-weight: bold; }
    #loadingMessage { color: #555; }
    #notificacion { color: green; }
  </style>
</head>
<body>
  <header>
    <nav>
      <a href="#" class="nav-link active" data-section="crear">Crear preguntas</a>
      <a href="#" class="nav-link" data-section="estudiar">Estudiar</a>
      <a href="#" class="nav-link" data-section="repasar">Repasar</a>
    </nav>
  </header>

  <!-- SECCIÓN CREAR PREGUNTAS -->
  <section id="crear" class="section active">
    <h2>Pegar Grupo de Preguntas</h2>
    <form id="grupoPreguntasForm">
      <label>Asignatura:</label>
      <input type="text" id="grupoAsignaturaInput" list="asignaturaList" placeholder="Escribe o selecciona asignatura">
      <datalist id="asignaturaList"></datalist>

      <label>Tema:</label>
      <input type="text" id="grupoTemaInput" list="temaList" placeholder="Escribe o selecciona tema">
      <datalist id="temaList"></datalist>

      <label>Es USMLE?</label>
      <input type="checkbox" id="grupoUsmle">
      <label>Pega las preguntas (separadas por comas y punto y coma ";")</label>
      <textarea id="grupoTexto" rows="6"></textarea>
      <button type="submit">Agregar Grupo de Preguntas</button>
      <div id="loadingMessage" style="display:none;">Cargando...</div>
      <div id="notificacion" style="display:none;">¡Grupo de preguntas agregado!</div>
    </form>
  </section>

  <!-- SECCIÓN ESTUDIAR -->
  <section id="estudiar" class="section">
    <h2>Estudiar</h2>
    <button onclick="cargarFiltrosEstudio()">Cargar preguntas disponibles</button>
    <div>
      <label>Asignatura:</label>
      <select id="estudioAsignatura"></select>
      <label>Tema:</label>
      <select id="estudioTema"></select>
      <button onclick="iniciarEstudio()">Iniciar Estudio</button>
    </div>
  </section>

  <!-- SECCIÓN REPASAR -->
  <section id="repasar" class="section">
    <h2>Repasar</h2>
    <button onclick="cargarFiltrosEstudio()">Cargar preguntas disponibles</button>
    <div>
      <label>Asignatura:</label>
      <select id="repasarAsignatura"></select>
      <label>Tema:</label>
      <select id="repasarTema"></select>
      <button onclick="iniciarRepaso()">Iniciar Repaso</button>
    </div>
  </section>

  <script>
    const APP_SCRIPT_URL = "YOUR_APPS_SCRIPT_URL_HERE";

    function enviarDatos(data, callback) {
      fetch(APP_SCRIPT_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(response => response.json())
      .then(callback)
      .catch(err => console.error(err));
    }

    function cargarFiltrosEstudio() {
      enviarDatos({ action: 'getPreguntas' }, function(res) {
        let preguntas = res.preguntas || [];
        let asignaturas = [...new Set(preguntas.map(q => q.asignatura))];
        let temas = [...new Set(preguntas.map(q => q.tema))];

        let selects = ['estudioAsignatura', 'repasarAsignatura'];
        selects.forEach(id => {
          let select = document.getElementById(id);
          select.innerHTML = '<option value="">-- Seleccionar --</option>';
          asignaturas.forEach(a => {
            let opt = document.createElement("option");
            opt.value = a;
            opt.textContent = a;
            select.appendChild(opt);
          });
        });

        selects = ['estudioTema', 'repasarTema'];
        selects.forEach(id => {
          let select = document.getElementById(id);
          select.innerHTML = '<option value="">-- Seleccionar --</option>';
          temas.forEach(t => {
            let opt = document.createElement("option");
            opt.value = t;
            opt.textContent = t;
            select.appendChild(opt);
          });
        });

        alert("Filtros actualizados con preguntas disponibles.");
      });
    }

    function iniciarEstudio() {
      let asignatura = document.getElementById('estudioAsignatura').value;
      let tema = document.getElementById('estudioTema').value;
      alert(`Iniciando estudio: ${asignatura} - ${tema}`);
    }

    function iniciarRepaso() {
      let asignatura = document.getElementById('repasarAsignatura').value;
      let tema = document.getElementById('repasarTema').value;
      alert(`Iniciando repaso: ${asignatura} - ${tema}`);
    }
  </script>
</body>
</html>
